<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>投資試算平台</title>
    <link rel="stylesheet" href="static/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <div class="container">
        <header>
            <h1>投資試算平台</h1>
            <p>輸入代號、金額與日期，計算歷史回測報酬率</p>
        </header>

        <main>
            <div class="tabs">
                <button class="tab-btn active" data-tab="dcaTab">定期定額試算</button>
                <button class="tab-btn" data-tab="compareTab">趨勢比較 (進階)</button>
            </div>

            <!-- DCA Calculator Tab -->
            <div id="dcaTab" class="tab-content active">
                <section class="input-section">
                    <form id="calcForm">
                        <div class="form-group">
                            <label>選擇市場</label>
                            <div class="radio-group">
                                <label class="radio-label">
                                    <input type="radio" name="market" value="tw" checked> 台股 (Taiwan)
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="market" value="us"> 美股 (US)
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="market" value="crypto"> 加密貨幣 (Crypto)
                                </label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="ticker">股票代號 (例如: 2330)</label>
                            <input type="text" id="ticker" name="ticker" placeholder="2330" required>
                        </div>

                        <div class="form-group">
                            <label for="amount">每月投資金額 (TWD)</label>
                            <input type="number" id="amount" name="amount" placeholder="10000" value="10000" required>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="start_date">開始日期</label>
                                <input type="date" id="start_date" name="start_date" value="2008-01-01" required>
                            </div>
                            <div class="form-group">
                                <label for="end_date">結束日期</label>
                                <input type="date" id="end_date" name="end_date" value="2025-01-01" required>
                            </div>
                        </div>

                        <button type="submit" id="submitBtn">開始計算</button>
                    </form>
                </section>

                <section id="resultSection" class="result-section hidden">
                    <div class="summary-cards">
                        <div class="card">
                            <h3>總投入金額</h3>
                            <p id="totalInvested">-</p>
                        </div>
                        <div class="card">
                            <h3>最終資產 (不含息)</h3>
                            <p id="finalValuePrice">-</p>
                            <small id="roiPrice" class="roi-small">-</small>
                        </div>
                        <div class="card">
                            <h3>最終資產 (含息)</h3>
                            <p id="finalValueDrip" class="highlight">-</p>
                            <small id="roiDrip" class="roi-small">-</small>
                        </div>
                        <div class="card">
                            <h3>單筆投入 (Lump Sum)</h3>
                            <p id="finalValueLump" class="highlight-lump">-</p>
                            <small id="roiLump" class="roi-small">-</small>
                        </div>
                    </div>

                    <div class="charts-grid">
                        <div class="chart-container">
                            <h4>資產成長 (投入成本 vs 市值)</h4>
                            <div class="canvas-wrapper">
                                <canvas id="assetChart"></canvas>
                            </div>
                        </div>
                        <div class="chart-container">
                            <h4>DCA 效益 (股價 vs 平均成本)</h4>
                            <div class="canvas-wrapper">
                                <canvas id="costChart"></canvas>
                            </div>
                        </div>
                        <div class="chart-container">
                            <h4>報酬率走勢 (ROI %)</h4>
                            <div class="canvas-wrapper">
                                <canvas id="roiChart"></canvas>
                            </div>
                        </div>
                        <div class="chart-container">
                            <h4>股數累積 (Total Shares)</h4>
                            <div class="canvas-wrapper">
                                <canvas id="sharesChart"></canvas>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Trend Comparison Tab -->
            <div id="compareTab" class="tab-content hidden">
                <section class="input-section">
                    <form id="compareForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>資產 1</label>
                                <select id="market1" class="market-select">
                                    <option value="tw">台股</option>
                                    <option value="us">美股</option>
                                    <option value="crypto">加密貨幣</option>
                                </select>
                                <input type="text" id="ticker1" name="ticker1" placeholder="2330" required>
                            </div>
                            <div class="form-group">
                                <label>資產 2</label>
                                <select id="market2" class="market-select">
                                    <option value="tw">台股</option>
                                    <option value="us" selected>美股</option>
                                    <option value="crypto">加密貨幣</option>
                                </select>
                                <input type="text" id="ticker2" name="ticker2" placeholder="AAPL" required>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="comp_start_date">開始日期</label>
                                <input type="date" id="comp_start_date" name="start_date" value="2020-01-01" required>
                            </div>
                            <div class="form-group">
                                <label for="comp_end_date">結束日期</label>
                                <input type="date" id="comp_end_date" name="end_date" value="2025-01-01" required>
                            </div>
                        </div>

                        <button type="submit" id="compareBtn">開始比較</button>
                    </form>
                </section>

                <section id="compareResultSection" class="result-section hidden">
                    <div class="summary-cards">
                        <div class="card full-width">
                            <h3>相關係數 (Correlation)</h3>
                            <p id="correlationValue" class="highlight">-</p>
                            <small>1 = 完全正相關, -1 = 完全負相關</small>
                        </div>
                    </div>
                    <div class="chart-container full-width">
                        <h4>趨勢比較 (漲跌幅 %)</h4>
                        <div class="canvas-wrapper">
                            <canvas id="compareChart"></canvas>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>
    <script src="static/script.js"></script>
</body>

</html>